<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form id="form" method="post">
    <table>
        <tr>
            <td>Login: </td><td><input id="login" type="text" name="login"></td>
        </tr>
        <tr>
            <td>Password: </td><td><input id="password" type="password" name="password"></td>
        </tr>
        <tr>
            <td><input type="submit" value="login"></td>
            <form action="register" method="get">
                <td><a href="register">Registration</a></td>
            </form>
        </tr>

    </table>
</form>
<script>
    /*
    HTTP1.1
    METHOD: POST
    CONTENT-TYPE: application/json
    ===================
    {"login":,"password":}*/

    var form = document.getElementById('form')

    form.addEventListener('submit', function (e) {

        e.preventDefault()

        var login = document.getElementById('login').value
        var password = document.getElementById('password').value

        fetch('login', {
            method: 'POST',
            body: JSON.stringify({
                login: login,
                password: password
            }),
            headers: {
                'Access-Control-Allow-Origin':'*',
                'Content-Type': 'application/json; charset=UTF-8'
            }
        })
            .then(function (response) {
                if (response.status === 200) {
                    window.location.replace('welcome');
                }
                else {

                    const textPromise = response.text();

                    textPromise.then(function (jsonString){
                        const jsonObject = JSON.parse(jsonString);

                        if(response.status === 401){
                            const location = jsonObject.location;
                            window.location.replace(location);
                        }else {
                            console.log(jsonObject);
                            console.log(jsonString);
                        }
                    })

                }
            })
    })

</script>
</body>
</html>